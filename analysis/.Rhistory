indices <- which(popfitness$Epoch==1)
x1 = popfitness$Generation[indices]
y1 = popfitness$Generation[indices]
e1 <- lm(y1~x1)
e1
1+1
1+1
summary(e1)
#Epoch 10
indices <- which(popfitness$Epoch==10)
x10 = popfitness$Generation[indices]
y10 = popfitness$Generation[indices]
e10 <- lm(y10~x10)
summary(e10)
e1$coefficients
x1
y1
#Time series model analysis?
#Crude linear regression analysis
#Epoch 1
indices <- which(popfitness$Epoch==1)
x1 = popfitness$Generation[indices]
y1 = popfitness$Fitness[indices]
e1 <- lm(y1~x1)
summary(e1)
#Epoch 10
indices <- which(popfitness$Epoch==10)
x10 = popfitness$Generation[indices]
y10 = popfitness$Fitness[indices]
e10 <- lm(y10~x10)
summary(e10)
?append
e1
e1.coefficients
e1[0]
e1$coefficients
e1$coefficients[1]
e1$coefficients[2]
source('~/Celldev.R')
coefflist
plot(coefflist)
summary(coefflist)
1+1
1+1
1+1
summary(coefflist)
summary(e10)
summary(e1)
e1$effects
e1$model
e1
summary(e1)
source('~/Celldev.R')
?abline
source('~/Celldev.R')
source('~/Celldev.R')
source('~/Celldev.R')
?corr
?cor
?cor.test
?plot
#Test relationship between variables?
#Fitness VS utility
lm.Fvu <- lm(Fitness~u)
summary(lm.Fvu)
cor.test(Fitness,u)
plot(u,Fitness,type = "p",xlab="Plasticity utility",ylab="Fitness")
abline(lm.Fvu, color="red")
abline(lm.Fvu, col="red")
y <- Fitness-u #Fitness without plasticity
plot(x,y,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
source('~/Celldev.R')
source('~/Celldev.R')
summary(y)
y <- Fitness-u #Fitness without plasticity
summary(y)
plot(x,y,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
plot(x,y,main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
summary(y)
plot(x,y,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
plot(x,y,main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
plot(y,main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
source('~/Celldev.R')
source('~/Celldev.R')
source('~/Celldev.R')
source('~/Celldev.R')
source('~/Celldev.R')
source('~/Celldev.R')
source('~/Celldev.R')
source('~/Celldev.R')
abline(0,0,col="red")
# Import data from Go
trajs <- read.table("plasticity.dat",header=TRUE)
View(trajs)
x <- trajs$Generation
Fit <- trajs$Fitness
Plas <- trajs$Plasticity
u <- trajs$Utility
plot(x,Fit,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
plot(x,Plas,ylim=c(0,1),main="Plot of plasticity over generations",xlab="Generation",ylab="Plasticity",type="l")
plot(x,u,ylim=c(-1,1),main="Plot of utility of plasticity",xlab="Generation",ylab="Utility",type="l")
abline(0,0,col="red")
source('~/Celldev.R')
plot(x,u,main="Plot of utility of plasticity",xlab="Generation",ylab="Utility",type="l")
plot(x,Fit,main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
plot(x,Plas,main="Plot of plasticity over generations",xlab="Generation",ylab="Plasticity",type="l")
plot(x,u,main="Plot of utility of plasticity",xlab="Generation",ylab="Utility",type="l")
source('~/Celldev.R')
# Import data from Go
trajs <- read.table("nocue.dat",header=TRUE)
View(trajs)
x <- trajs$Generation
Fit <- trajs$Fitness
Plas <- trajs$Plasticity
u <- trajs$Utility
plot(x,Fit,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
plot(x,Plas,ylim=c(0,1),main="Plot of plasticity over generations",xlab="Generation",ylab="Plasticity",type="l")
plot(x,u,ylim=c(-1,1),main="Plot of utility of plasticity",xlab="Generation",ylab="Utility",type="l")
abline(0,0,col="red")
plot(x,u,main="Plot of utility of plasticity",xlab="Generation",ylab="Utility",type="l")
abline(0,0,col="red")
?which
indices <- which(trajs$Epoch=1)
indices <- which(trajs$Epoch==1)
x
indices <- which(trajs$Epoch==2)
indices
?for
source('~/Celldev.R')
#plot second epoch
indices = which(trajs$epoch==2)
Fit2 <- trajs$Fitness[indices]
# Import data from Go
trajs <- read.table("nocue.dat",header=TRUE)
#plot second epoch
indices = which(trajs$epoch==2)
Fit2 <- trajs$Fitness[indices]
# Import data from Go
trajs <- read.table("nocue.dat",header=TRUE)
# Import data from Go
trajs <- read.table("nocue.dat",header=TRUE)
View(trajs)
#plot second epoch
indices = which(trajs$epoch==2)
Fit2 <- trajs$Fitness[indices]
#plot second epoch
indices = which(trajs$Epoch==2)
Fit2 <- trajs$Fitness[indices]
#plot second epoch
indices = which(trajs$Epoch==2)
Fit2 <- trajs$Fitness[indices]
Plas2 <- trajs$Plasticity[indices]
u2 <- trajs$Utility[indices]
plot(Plas2,main="Plot of plasticity over generations",xlab="Generation",ylab="Plasticity",type="l")
plot(u2,main="Plot of utility of plasticity",xlab="Generation",ylab="Utility",type="l")
abline(0,0,col="red")
source('~/Celldev.R')
source('~/Celldev.R')
indices = which(trajs$Epoch==1)
Fit1  <- traj$Fitness[indices]
plot(Fit1,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
#plot second epoch
indices = which(trajs$Epoch==2)
indices = which(trajs$Epoch==1)
Fit1  <- traj$Fitness[indices]
plot(Fit1,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
Fit1  <- traj$Fitness[indices]
indices = which(trajs$Epoch==1)
Fit1  <- trajs$Fitness[indices]
plot(Fit1,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
#plot second epoch
indices = which(trajs$Epoch==2)
# Import data from Go
trajs <- read.table("traj.dat",header=TRUE)
x <- trajs$Generation
Fit <- trajs$Fitness
Plas <- trajs$Plasticity
u <- trajs$Utility
plot(x,Fit,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
# Import data from Go
trajs <- read.table("traj.dat",header=TRUE)
View(trajs)
x <- trajs$Generation
Fit <- trajs$Fitness
Plas <- trajs$Plasticity
u <- trajs$Utility
plot(x,Fit,ylim=c(0,1),main="Plot of fitness over generations",xlab="Generation",ylab="Fitness",type="l")
test <- read.table("test.dat", header=TRUE)
View(test)
source('~/Celldev.R')
setwd("~/Documents/GitHub/evodevo/analysis")
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1:25]
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1:25]
MSE[1:30]
gen
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1]
gen <- test$Generation
MSE <- test$MSE
MSE[1]
summary(test)
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
c0
c0 = MSE[length(MSE)]
c0
MSE[1]
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
phenotypes <- read.table("upop20211223trainphen.dat",header=FALSE)
pca <- prcomp(phenotypes)
(pca$sdev[1])**2
summary(PCA)
summary(pca)
test <- read.table("upop20211223-0testtraj.dat",header=TRUE)
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
pca$sdev[20]^2
summary(pca)
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1]
MSE[length(MSE)]
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1]
MSE[length(MSE)]
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1]
MSE[-1]
MSE[length(MSE)]
pca$sdev[10]^2
summary(pca)
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1]
MSE[200]
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1]
MSE[length(MSE)]
MSE
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
test <- read.table("upop20220101traintraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 1.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
print(summary(expfit))
plot(gen,MSE,ylim=c(0,2),main="Exponential fit")
lines(fitted(expfit),type="l",col="blue")
plot(gen,MSE,ylim=c(0,2),main="Exponential fit")
lines(MSE,fitted(expfit),type="l",col="blue")
plot(gen,MSE,ylim=c(0,2),main="Exponential fit")
lines(gen,fitted(expfit),type="l",col="blue")
plot(gen,MSE,ylim=c(0,2),main="Exponential fit",type="l")
print(summary(expfit))
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
gen <- test$Generation
MSE <- test$MSE
plot(gen,MSE,ylim=c(0,2),main="Exponential fit")
lines(gen,fitted(expfit),type="l",col="blue")
test <- read.table("upop20220101traintraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 1.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
print(summary(expfit))
test <- read.table("upop20220102traintraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 1.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
print(summary(expfit))
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
test <- read.table("upop20220101traintraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
plot(gen,MSE,type="l",ylim=c(0,2))
sigfit <- nls(MSE~g(gen,a,b,c,d),start=list(a=a0,b=b0,c=c0,d=d0))
print(summary(sigfit))
sigfit <- nls(MSE~g(gen,a,b,c,d),start=list(a=a0,b=b0,c=c0,d=d0))
a0 = MSE[1]-MSE[length(MSE)]
b0 = 1.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
print(summary(expfit))
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
plot(gen,MSE,ylim=c(0,2),type="l")
("upop20220101traintraj.dat",header=TRUE)
test <- read.table("upop20220101traintraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 10.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
print(summary(expfit))
plot(gen,MSE,ylim=c(0,2),main="Exponential fit")
lines(gen,fitted(expfit),type="l",col="blue")
test <- read.table("upop20220102traintraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 10.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
print(summary(expfit))
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
test <- read.table("upop20220104testtraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 10.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
plot(gen,MSE,ylim=c(0,2),main="Exponential fit")
print(summary(expfit))
lines(gen,fitted(expfit),type="l",col="blue")
print("Exponential stopping time")
print(ceiling(3*coef(expfit)['b']))
g <- function(x,a,b,c,d) {
d + a/(1+exp((x-c)/b))
}
a0 = MSE[1] - MSE[length(MSE)]
b0 = 10.0
c0 = 0.1
d0 = MSE[length(MSE)]
sigfit <- nls(MSE~g(gen,a,b,c,d),start=list(a=a0,b=b0,c=c0,d=d0))
MSE[1:40]
MSE[1:50]
diff(MSE)[1:50]
test <- read.table("upop20220104testtraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 10.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
print(summary(expfit))
plot(gen,MSE,ylim=c(0,2),main="Exponential fit")
lines(gen,fitted(expfit),type="l",col="blue")
print("Exponential stopping time")
print(ceiling(3*coef(expfit)['b']))
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE
MSE[1:30]
MSE[1:40]
MSE[1:50]
mean(MSE[20:200])
mean(MSE[26:200])
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
View(pg)
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1:30]
MSE
plot(gen,MSE,main="Epig",ylim=c(0,0.3))
lines(gen,fitted(sigfit),type="l",col="blue")
plot(gen,MSE,main="Epig",ylim=c(0,0.3),type="l")
lines(gen,fitted(sigfit),type="l",col="blue")
which.min(MSE)
MSE[20]
MSE[25]
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1:30]
plot(gen,MSE,main="Epig+HOC",ylim=c(0,0.3),type="l")
lines(gen,fitted(sigfit),type="l",col="blue")
plot(gen[1:50],MSE[1:50],main="Epig+HOC",ylim=c(0,0.3),type="l")
lines(gen,fitted(sigfit),type="l",col="blue")
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
MSE[1:30]
MSE[1:40]
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
test <- read.table("upop20220104testtraj.dat",header = TRUE)
gen <- test$Generation
aplas <-test$Anc_Cue_Plas
nplas <- test$Nov_Cue_Plas
test <- read.table("upop20220105testtraj.dat",header = TRUE)
gen <- test$Generation
aplas <-test$Anc_Cue_Plas
nplas <- test$Nov_Cue_Plas
plot(gen,aplas)
plot(gen,nplas)
oplas <- test$Obs_Plas
plot(gen,oplas)
plot(gen,nplas,ylab="Plasticity",col="blue")
plot(gen,nplas,ylab="Plasticity",col="blue",type="l",ylim=c(0,1.0))
lines(gen,aplas,col="red",type="l")
test <- read.table("upop20220105testtraj.dat",header = TRUE)
gen <- test$Generation
aplas <-test$Anc_Cue_Plas
nplas <- test$Nov_Cue_Plas
oplas <- test$Obs_Plas
plot(gen,nplas,ylab="Cue Plasticity",col="blue",type="l",ylim=c(0,1.0))
lines(gen,aplas,col="red",type="l")
axis(side=4,at=c(0.0,0.02,0.04,0.06,0.08.0.10))
("upop20220108testtraj.dat",header=TRUE)
test <- read.table("upop20220108testtraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 10.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
print(summary(expfit))
plot(gen,MSE,ylim=c(0,2),main="Exponential fit")
lines(gen,fitted(expfit),type="l",col="blue")
print("Exponential stopping time")
print(ceiling(3*coef(expfit)['b']))
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
?plot
plot(gen,log(MSE))
lines(gen,log(fitted(expfit)),type="l",col="blue")
plot(gen,MSE,log="y")
lines(gen,log(fitted(expfit)),type="l",col="blue")
lines(gen,fitted(expfit))
plot(gen,MSE,log="y")
lines(gen,fitted(expfit))
test <- read.table("upop20220106testtraj.dat",header=TRUE)
gen <- test$Generation
MSE <- test$MSE
f <- function(x,a,b,c){
c + a*exp(-x/b)
}
a0 = MSE[1]-MSE[length(MSE)]
b0 = 10.0
c0 = MSE[length(MSE)]
expfit <- nls(MSE~f(gen,a,b,c),start=list(a=a0,b=b0,c=c0))
plot(gen,MSE,log="y")
test <- read.table("upop20220105testtraj.dat",header = TRUE)
gen <- test$Generation
aplas <-test$Anc_Cue_Plas
nplas <- test$Nov_Cue_Plas
oplas <- test$Obs_Plas
plot(gen,nplas,ylab="Cue Plasticity",col="blue",type="l",ylim=c(0,1.0))
lines(gen,aplas,col="red",type="l")
test <- read.table("upop20220106testtraj.dat",header = TRUE)
gen <- test$Generation
aplas <-test$Anc_Cue_Plas
nplas <- test$Nov_Cue_Plas
oplas <- test$Obs_Plas
plot(gen,nplas,ylab="Cue Plasticity",col="blue",type="l",ylim=c(0,1.0))
lines(gen,aplas,col="red",type="l")
plot(gen,nplas,ylab="Cue Plasticity",col="blue",type="l",ylim=c(0,2.0)
)
lines(gen,aplas,col="red",type="l")
test <- read.table("upop20220107testtraj.dat",header = TRUE)
gen <- test$Generation
aplas <-test$Anc_Cue_Plas
nplas <- test$Nov_Cue_Plas
oplas <- test$Obs_Plas
plot(gen,nplas,ylab="Cue Plasticity",col="blue",type="l",ylim=c(0,2.0))
lines(gen,aplas,col="red",type="l")
test <- read.table("upop20220108testtraj.dat",header = TRUE)
gen <- test$Generation
aplas <-test$Anc_Cue_Plas
nplas <- test$Nov_Cue_Plas
oplas <- test$Obs_Plas
plot(gen,nplas,ylab="Cue Plasticity",col="blue",type="l",ylim=c(0,2.0))
lines(gen,aplas,col="red",type="l")
debugSource('~/Documents/GitHub/evodevo/analysis/decaytest.R')
source('~/Documents/GitHub/evodevo/analysis/PGtraj.R')
source('~/Documents/GitHub/evodevo/analysis/decaytest.R')
